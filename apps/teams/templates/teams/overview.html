{% extends "base.html" %}
{% load static %}

{% block content %}
  <div class="main-heading">
    <h1>Teams</h1>
  </div>

  <!-- Create a New Team -->
  <section class="section">
    <h2>Create a New Team</h2>
    <p>Create a new team here and you will be able to select it in the dropdown below.</p>
    <form method="post" class="team-create-form" action="{% url 'teams:teams_overview' %}">
      {% csrf_token %}
      <input type="text" name="name" placeholder="Enter Team Name" required class="team-input">
      <button type="submit" name="create_team" class="button">Create</button>
    </form>
  </section>

  <!-- Edit / Manage a Team -->
  <section class="section">
    <h2>Edit a Team</h2>

    <!-- switcher dropdown -->
    <form method="post" class="team-switch-form" action="{% url 'teams:teams_overview' %}">
      {% csrf_token %}
      <label for="selected_team">Select the team youâ€™d like to edit:</label>
      <div class="team-switch">
        <select name="selected_team" id="selected_team">
          <option value="" disabled {% if not selected_team %}selected{% endif %}>-- Select Team --</option>
          {% for t in teams %}
            <option value="{{ t.id }}" {% if selected_team and t.id == selected_team.id %}selected{% endif %}>
              {{ t.name }}
            </option>
          {% endfor %}
        </select>
        <button type="submit" name="edit_team" class="button">Go</button>
      </div>
    </form>

    {% if selected_team %}
      {% include "teams/_member_table.html" with team=selected_team editing_id=editing_id %}

      <!-- Rename Team -->
      <form method="post" class="form--extend-table" action="{% url 'teams:rename_team' selected_team.id %}">
        {% csrf_token %}
        <p><em>Rename Team:</em></p>
        <input type="text" name="name" value="{{ selected_team.name }}" required>
        <button type="submit" class="button">Rename</button>
      </form>
      
      <!-- Delete Team -->
      <hr>

      <div class="section" style="margin-top:1rem;">
        <form
          method="post"
          action="{% url 'teams:delete_team' selected_team.id %}"
          style="display:inline;"
          onsubmit="return confirm('Delete team & all its members?')"
        >
          {% csrf_token %}
          <button type="submit" class="text-button text-danger">Delete Team</button>
        </form>
      </div>
    {% endif %}
  </section>
{% endblock %}