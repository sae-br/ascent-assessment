{% extends "base_public.html" %}
{% load static %}
{% block title %}Ascent Assessment for Teams{% endblock %}

{% block content %}
<form id="assessment-form" method="post" class="assessment-form">
  {% csrf_token %}

  <!-- Progress -->
  <div class="progress-wrap" aria-hidden="true">
    <div class="progress-bar">
      <span class="progress-fill"></span>
    </div>
    <div class="progress-meta">
      <span class="progress-text">
        <strong>Step <span id="stepNum">1</span></strong> of
        <span id="stepTotal">1</span>
      </span>
    </div>
  </div>

  <div id="steps">
    <!-- Intro step -->
    <section class="step is-active" data-step="0" aria-label="Introduction">
        <h2>Hello, {{ member.name }}!</h2>
        <p>Please take a few minutes to answer the following questions honestly. Youâ€™ll move one question at a time. Your answers are saved when you submit on the last step.</p>
    </section>

    <!-- One step per question -->
    {% for question in questions %}
    <section class="step" data-step="{{ forloop.counter }}" aria-labelledby="q{{ forloop.counter }}">
      <fieldset class="question-card">
        <legend id="q{{ forloop.counter }}"><strong>{{ forloop.counter }}.</strong> {{ question.text }}</legend>

        <div class="choices">

            <!-- 0 -->
            <label class="choice">
                <input class="visually-hidden" type="radio" name="question_{{ question.id }}" value="0" required>
                <span class="choice-label">
                <span class="choice-text">Consistently</br>Untrue</span>
                </span>
            </label>
            <!-- 1 -->
            <label class="choice">
                <input class="visually-hidden" type="radio" name="question_{{ question.id }}" value="1" required>
                <span class="choice-label">
                <span class="choice-text">Somewhat</br>Untrue</span>
                </span>
            </label>
            <!-- 2 -->
            <label class="choice">
                <input class="visually-hidden" type="radio" name="question_{{ question.id }}" value="2" required>
                <span class="choice-label">
                <span class="choice-text">Somewhat</br>True</span>
                </span>
            </label>
            <!-- 3 -->
            <label class="choice">
                <input class="visually-hidden" type="radio" name="question_{{ question.id }}" value="3" required>
                <span class="choice-label">
                <span class="choice-text">Consistently</br>True</span>
                </span>
            </label>
        </div>
      </fieldset>
    </section>
    {% endfor %}

    <!-- Final step -->
    <section class="step" data-step="final" aria-label="Review and Submit">
      <p>All done! When you click submit, your answers will be recorded.</p>
      <button type="submit" class="button--primary">Submit</button>
    </section>
  </div>

  <!-- Inline validation message area -->
  <div id="formError" class="form-error" hidden>Please select an option to continue.</div>

  <!-- Pager controls -->
  <div class="pager">
    <button type="button" class="button--secondary" id="prevBtn" disabled>Back</button>
    <button type="button" class="button--secondary" id="nextBtn">Next</button>
  </div>
</form>
{% endblock %}

{% block extra_scripts %}
  <script src="{% static 'assessments/scripts/start.js' %}" defer></script>
{% endblock %}